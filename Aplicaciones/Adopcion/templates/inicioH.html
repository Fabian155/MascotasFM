{% extends "plantilla.html" %}
{% load static %}
{% block contenido %}

<h2 class="mb-3">Solicitudes de Adopción</h2>

<table id="tbl_solicitudes" class="table table-bordered table-hover">
  <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Adoptante</th>
      <th>Animal</th>
      <th>Fecha</th>
      <th>Observación</th>
      <th>Estado</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for s in solicitudes %}
    <tr>
      <td>{{ s.id }}</td>
      <td>{{ s.adoptante.nombre }}</td>
      <td>{{ s.animal.nombre }}</td>
      <td>{{ s.fecha_solicitud }}</td>
      <td>{{ s.observacion|default:"-" }}</td>
      <td>
        {% if s.estado == "APROBADA" %}
          <span class="badge bg-success">{{ s.estado }}</span>
        {% elif s.estado == "RECHAZADA" %}
          <span class="badge bg-danger">{{ s.estado }}</span>
        {% else %}
          <span class="badge bg-warning text-dark">{{ s.estado }}</span>
        {% endif %}
      </td>
      <td>
        <a href="{% url 'aprobar' s.id %}" class="btn btn-success btn-sm">Aprobar</a>
        <a href="{% url 'actualizar_estado' s.id 'RECHAZADA' %}" class="btn btn-danger btn-sm">Rechazar</a>
        <a href="{% url 'actualizar_estado' s.id 'PENDIENTE' %}" class="btn btn-warning btn-sm text-dark">Pendiente</a>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="7" class="text-center text-muted">No hay solicitudes.</td></tr>
    {% endfor %}
  </tbody>
</table>

<script>
  $(function () {
    $('#tbl_solicitudes').DataTable({
      dom: 'Bfrtip',
      buttons: ['copy', 'excel', 'pdf', 'print'],
      language: { url: 'https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json' }
    });
  });
</script>

{% if messages %}
  {% for m in messages %}
    <script>
      Swal.fire({title: "Notificación", text: "{{ m }}", icon: "success"});
    </script>
  {% endfor %}
{% endif %}

{% endblock %}
