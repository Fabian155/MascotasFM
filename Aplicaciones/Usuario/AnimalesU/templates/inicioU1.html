{% extends "plantillaU.html" %}
{% load static %}
{% block contenido %}

<h2 class="text-center mb-4 text-primary">Mascotas Disponibles </h2>

{% if not tiene_perfil_adoptante %}
<div class="alert alert-warning text-center" role="alert">
  Antes de adoptar por favor completa tu 
  <a href="{% url 'nuevoAdoptado' %}" class="text-dark fw-bold">registro de adoptante</a>
</div>
{% endif %}

<div class="container">
  <div class="row justify-content-center">
    {% for a in animales %}
    <div class="col-md-4 col-sm-6 mb-3">
      <div class="card" style="width: 100%; box-shadow: 1px 2px 5px">
        
        {% if a.logo %}
          <img src="{{ a.logo.url }}" alt="{{ a.nombre }}" class="card-img-top" style="height: 200px; object-fit: cover;">
        {% else %}
          <img src="{% static 'img/noimage.jpg' %}" alt="Sin imagen" class="card-img-top" style="height: 200px;">
        {% endif %}

        <div class="card-body" style="text-align: center;">
          <h5 class="card-title">{{ a.nombre|upper }}</h5>
          <p class="card-text">
            <span class="badge bg-secondary">{{ a.especieid }}</span>
            <span class="badge bg-info">{{ a.edad }} años</span>
          </p>

          <p style="font-size: 13px; ">{{ a.salud }}</p>

          {% if a.estado == "DISPONIBLE" %}
          <span class="badge bg-success">Disponible</span>
          {% elif a.estado == "ADOPTADO" %}
          <span class="badge bg-danger">Adoptado</span>
          {% else %}
          <span class="badge bg-light text-dark">{{ a.estado }}</span>
          {% endif %}

          <div class="mt-2">
            <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#modalAdoptar{{ a.id }}">
              Adoptar
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="modalAdoptar{{ a.id }}" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">

          <div class="modal-header bg-success text-white">
            <h5 class="modal-title">Formulario de adopción</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>

          <div class="modal-body">
            <div class="text-center">
              {% if a.logo %}
                <img src="{{ a.logo.url }}" width="100" height="100" style="object-fit: cover; border-radius: 10px;">
              {% else %}
                <img src="{% static 'img/noimage.jpg' %}" width="100" height="100">
              {% endif %}
              <h6 class="mt-2">{{ a.nombre }}</h6>
              <p><b>Especie:</b> {{ a.especieid }}</p>
              <p><b>Edad:</b> {{ a.edad }}</p>
              <p><b>Salud:</b> {{ a.salud }}</p>
            </div>

            <form action="{% url 'adopcionu:inicioG' a.id %}" method="get">
              {% csrf_token %}
              <div style="text-align: center;">
                <button type="submit" class="btn btn-success">Enviar</button>
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
              </div>
            </form>

          </div>
        </div>
      </div>
    </div>

    {% endfor %}
  </div>
</div>

{% if messages %}
{% for message in messages %}
<script>
  Swal.fire({
    title: "Mensaje",
    text: "{{ message }}",
    icon: "success"
  });
</script>
{% endfor %}
{% endif %}

{% endblock %}
