{% extends "plantillaU.html" %}
{% load static %}
{% block contenido %}

<h2 class="mb-3">Mascotas disponibles</h2>

<table class="table table-bordered table-striped table-hover" id="tbl_animales_u">
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Especie</th>
      <th>Edad</th>
      <th>Salud</th>
      <th>Foto</th>
      <th>Ficha PDF</th>
      <th>Acción</th>
    </tr>
  </thead>
  <tbody>
    {% for a in animales %}
      <tr>
        <td>{{ a.id }}</td>
        <td>{{ a.nombre }}</td>
        <td>{{ a.especieid }}</td>
        <td>{{ a.edad }}</td>
        <td>{{ a.salud }}</td>

        <td>
          {% if a.logo %}
            <img src="{{ a.logo.url }}" alt="{{ a.nombre }}" style="height:70px;">
          {% else %}
            <span class="text-muted">Sin imagen</span>
          {% endif %}
        </td>

        <td>
          {% if a.pdf %}
            <a href="{{ a.pdf.url }}" target="_blank">Ver PDF</a>
          {% else %}
            <span class="text-muted">No disponible</span>
          {% endif %}
        </td>

        <td>
          <form action="{% url 'adopcionu:inicioG' a.id %}" method="post" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary btn-sm">
              Solicitar adopción
            </button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="8" class="text-center text-muted">No hay mascotas registradas.</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  // DataTables en español con botones
  document.addEventListener('DOMContentLoaded', function () {
    $('#tbl_animales_u').DataTable({
      dom: 'Bfrtip',
      buttons: ['copy', 'csv', 'excel', 'pdf', 'print'],
      language: { url: 'https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json' }
    });
  });
</script>

{% if messages %}
  {% for message in messages %}
    <script>
      Swal.fire({ title: "Mensaje", text: "{{ message }}", icon: "success" });
    </script>
  {% endfor %}
{% endif %}

{% endblock %}
